<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>Windows Update更新卡住或失敗的解決辦法</h1><p>所管理的伺服器群中，有幾台在2017年Intel爆發CPU漏洞時期，微軟頻繁進行更新（以及針對更新的更新），遺留下很多垃圾更新檔案，這些更新有些甚至已經被微軟拋棄了，可是電腦的Windows Update還是偶爾會跳出說有一個「KBXXXX更新失敗，請重新再試」的字眼。</p><p>更新失敗鬼打牆的路徑大概如下：</p><ol><li><p>KB4053579（舉例）更新失敗，請重新再試。</p></li><li><p>按下更新按鈕。</p></li><li><p>電腦簡單掃描一下，該更新失敗的訊息消失。</p></li><li><p>過幾天後，又會重新再出現於Windows Update的畫面中。</p></li><li><p>曾經想要到Windows Update Catalog試著手動下載該更新，發現該更新竟然爛到被<a href="https://www.catalog.update.microsoft.com/Search.aspx?q=KB4053579">微軟整個移除</a>了，表示這個更新本身有嚴重的問題，可能在其他的KB被一併解決。</p></li></ol><p><a href=https://support.microsoft.com/zh-tw/help/4053579/windows-10-update-kb4053579>KB4053579</a>主要想要解決的事情：</p><p>解決安裝 KB4041688、KB4052231 或 KB4048953 之後，出現錯誤「CDPUserSvc_XXXX 已經停止運作」的問題。 此外也解決了事件識別碼 1000 在應用程式事件記錄檔中的記錄問題。 其指出 svchost.exe_CDPUserSvc_XXXX 已經停止運作，以及失敗的模組名稱為 "cdp.dll"。</p><h2>可以試著移除Windows Update更新記錄檔看看</h2><p>針對這種更新鬼打牆的情況，可以試著移除本機端的更新記錄檔（更新歷程）看看，不敢說一定有用，但對我來說是有發揮其功效。</p><p>Step 1. 執行services.msc。</p><p>Step 2. 停止Windows Update服務。（這個服務列表視窗先不要關掉）</p><p>Step 3. 到本機目錄「C:\Windows\SoftwareDistribution\DataStore」，把這個目錄下所有的檔案砍掉。</p><p>Step 4. 重新開啟Windows Update服務。</p><p>大概這樣就解決了，請到Windows Update按下檢查更新，重新掃描的時間會耗費比較久，你也可以過幾天後再觀察看看KB錯誤的訊息是否消除。</p><p>最後附上一篇如何手動進行Windows Update的文章：<a href=https://support.microsoft.com/zh-tw/help/323166/how-to-download-updates-that-include-drivers-and-hotfixes-from-the-win>如何從 Windows Update Catalog 下載包含驅動程式和 Hotfix 的更新</a></p><h6>WindowsUpdate KB4053579 Error Fix Reapir Solve</h6></main><footer></footer><script src=/.file/site.js></script></body></html>