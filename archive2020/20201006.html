<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>在Windows10中固定透過USB分享產生的網路介面編號</h1><p>在外面有很多時候，我們會將筆記型電腦透過USB連線分享手機行動網路上網，這時候會有一個困擾產生，當USB連線建立成功後你的電腦會跳出一個新建立的網路介面（NIC；Network Interface Controller）隨後帶上一組數字編號，更正確的來說這個介面其實中文名稱叫做網路驅動程式介面規範（Remote NDIS；Network Driver Interface Specification），這組Remote NDIS數字編號會不斷的往上計數，對於某些人來說這是一個困擾。</p><p>這篇文章討論的是如何將這組編號「完美的」重置，也會指出如何「不完美的」將編號固定的方法（*不建議使用）。</p><h2>將RemoteNDIS連線後產生的編號重置</h2><p>這點可以完美的解決，請遵循下列步驟進行：</p><p>Step 1. 打開regedit，進入到下列位置「\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\」。</p><p>Step 2. 把這個目錄下把所有出現的GUID尋訪一次，每一個都進去看「ProfileName」是否有出現「網路」二字且後面帶著編號，有的話就把這串GUID機碼整個刪除。（註：英文版的會以「Network XX」來命名。）</p><p>Step 3. 完成後再度接上手機的USB網路分享，就可以看到號碼重置的效果了。</p><h2>讓RemoteNDIS連線後產生的編號不再跳動（不再往上計數）</h2><p>這問題有兩種解法但都不完美，所以基本上我自己不會去使用，僅把這些方法整理在此供給有需要的朋友參考，如果有這方面需求請自己斟酌使用。</p><h3>利用IP固定Profile</h3><p>這個方法就是USB連線完成後，利用「ipconfig /all」去查看當前的IPv4資訊，把IP Address、子網路遮罩、閘道等資訊抄下來後，跑去當前的網路卡屬性中編輯寫入，原本是自動IP分派的Profile就此被固定下來，下次再度連線就不會再跳動了。</p><p>這個方法個人覺得家中桌機或許可以一試，但如果是筆電必須到處工作移動，這樣的作法就有點好笑了，因為不可能每個地方的基地台的內部DHCP配置，都跟你家最近的那個基地台一致啊！</p><h3>修改regedit固定NDIS編號</h3><p>Step 1. 打開regedit，進入到下列位置「HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class{4d36e972-e325-11ce-bfc1-08002be10318}」。</p><p>Step 2. 新增一組DWORD (32-bit)，命名為「*NdisDeviceType」數值給予「1」。</p><p>Step 3. 重新開機後，接上USB你就會發現Windows 10不再跳出選定網路位置的彈出式窗，也不會有網路卡編號亂跳的問題。</p><p>這個方法有一個很嚴重的缺點，就是所有的UWP（Universal Windows Platform）等級的應用程式都會無法使用網路，例如在Windows市集中內建的Calendar...等。因為我在作業上還是需要有些UWP應用軟體來輔助，所以這個方案我認為也不可行。</p><p>以上資訊整理給大家參考。</p><h6>Windows10 NetworkInterface NetworkProfile UsbTethering RemoteNDIS CounterReset CounterFixed Network1 Network2 Network99</h6></main><footer></footer><script src=/.file/site.js></script></body></html>