<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>解決VisualStudio會自動把VB.NET的多行字串寫法自動移除</h1><p>最近在維護古蹟的時候，發現VisualStudio會自動把VB.NET的多行字串寫法<code>_ 底線</code>，在<code>儲存</code>的當下<code>自動移除</code>，實在有夠惱人。會自動移除的原因是因為VB.NET在最後幾次的改版中，就加入了跟比較現代語言一致性的<code>多行字串</code>寫法，但...並不是每一個VB.NET古蹟都有最新版的編譯器啊！</p><h2>VB.NET的多行號字串寫法（串接）</h2><p>最古老的VB.NET多行字串的寫法如下：</p><pre><code class=language-txt>Dim x As String = "String111" &amp; _
  "String222" &amp; _
  "String333"
</code></pre><p>這樣的寫法是可以通過舊版本的VB.NET編譯器的，但當你在VisualStudio按下儲存按鈕的時候，你會發現一瞬間<code>&amp; _</code>會被改變成<code>&amp;</code>，導致編譯失敗。會形成這樣的原因是因為VisualStudio認為大家都應該升級到最新版的VB.NET編譯器了，因此根本不須這樣的寫法。但它沒有顧慮到的是仍然有一部分的人有維護古蹟的需求。被更改過後的程式碼會變成下列，導致編譯器認為你的程式寫錯了：</p><pre><code class=language-txt>Dim x As String = "String111" &amp;
  "String222" &amp;
  "String333"
</code></pre><h2>修正VisualStudio自動將VB.NET的多行寫法底線拿掉</h2><p>這個狀況是可以改善的，只要透過設定VisualStudio即可，請依循下列步驟關閉選項：</p><ol><li><p><code>工具</code> > <code>選項</code>。</p></li><li><p><code>文字編輯器</code> > <code>Visual Basic</code> > <code>進階</code>。</p></li><li><p>將<code>程式碼美化排列 (重新格式化)</code>的勾勾取消（關閉）。</p></li></ol><p><img src=https://content.slashview.com/img/2024/20241106_01.jpg alt="" /></p><p>透過上面的設定，就可以把這個只要按下儲存就會自動幫你修改多行字串的問題消除，但同時你也將VisualStudio自動排版VB.NET程式碼功能一併取消掉了。（我個人認為完全無妨，畢竟古蹟就是古蹟，系統可達到需求正常使用就好了。）</p><h3>感想</h3><p>有些人會說，遇到這種狀況就是應該要<code>重構</code>啊！怎麼會允許這樣的事實繼續存在？遇到這種聖母病我都一律回答：你有空把所有的古蹟翻修一次你來啊，站著說話腰不疼？</p><h6>VB.NET Multiline strings in</h6></main><footer></footer><script src=/.file/site.js></script></body></html>