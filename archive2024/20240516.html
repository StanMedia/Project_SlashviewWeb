<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>Windows下的滑鼠自動移動程式（免安裝，不需要管理者權限）</h1><p>最近被<code>e等公務園</code>的網站強迫每個人都要在線上關注的觀賞課程，這個規定立意良善，但不是每個人都需要某個課程（對我來說是課程太簡單不適合我），總之每個人都有自己的理由，如此一來立意良善的設定就變成強迫了。</p><p>上網查了一些資訊，要達成在Windows作業系統下自動移動滑鼠，都需要下載安裝特定的執行檔（這種小程式好像在疫情期間特別興盛，可能是老闆想要遠端監控你有沒有乖乖的在家上班），但我怕有病毒不想下載。順手利用<code>powershell</code>撰寫了一個滑鼠定時自動移動的程式碼，供給有需要的人參考使用。</p><h2>滑鼠定時自動移動程式碼</h2><ol><li>請開啟記事本，將下列程式碼貼上：</li></ol><pre><code class=language-txt>param (
	[int]$iSeconds = 10
)

Clear-Host
$host.ui.RawUI.WindowTitle = "@ Mouse Mover @"
$Host.UI.RawUI.BackgroundColor = "Black"
$Host.UI.RawUI.ForegroundColor = "White"
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8


Write-Host "_  _ ____ _  _ ____ ____ _  _ ____ _  _ ____ ____ " -ForegroundColor Magenta
Write-Host "|\/| |  | |  | [__  |___ |\/| |  | |  | |___ |__/ " -ForegroundColor Magenta
Write-Host "|  | |__| |__| ___] |___ |  | |__|  \/  |___ |  \ " -ForegroundColor Magenta
Write-Host ""
Write-Host "This program will continuously move your mouse cursor at an interval of every " -NoNewline
Write-Host "$iSeconds" -ForegroundColor Cyan -NoNewline
Write-Host " seconds."
Write-Host ""
Write-Host "Just " -NoNewline
Write-Host "CLOSE" -ForegroundColor Red -NoNewline
Write-Host " this window to " -NoNewline
Write-Host "STOP" -ForegroundColor Green -NoNewline
Write-Host " mouse auto-moving."
Write-Host ""

[int]$iCounter = 6
while($iCounter -gt 0) {
    [Console]::SetCursorPosition(0, [Console]::CursorTop)
    Write-Host "Starting countdown: $iCounter" -NoNewline
    $iCounter -= 1
    Start-Sleep -Seconds 1
}

function Hide-ConsoleWindow {
  Add-Type -Name Window -Namespace Console -MemberDefinition '
    [DllImport("Kernel32.dll")]
    public static extern IntPtr GetConsoleWindow();
    [DllImport("user32.dll")]
    public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
  '
  $oConsole = [Console.Window]::GetConsoleWindow()
  [Console.Window]::ShowWindow($oConsole, 6)
  return $null
}
$null = Hide-ConsoleWindow

[Console]::SetCursorPosition(0, [Console]::CursorTop)
Write-Host "... ### Running now ### ..." -NoNewline

Add-Type -AssemblyName System.Windows.Forms
$screenWidth = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Width
$screenHeight = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds.Height
while(1) {
  $x = Get-Random -Minimum 0 -Maximum $screenWidth
  $y = Get-Random -Minimum 0 -Maximum $screenHeight
  [Windows.Forms.Cursor]::Position = New-Object System.Drawing.Point($x, $y)
  Start-Sleep -Seconds $iSeconds
}
</code></pre><ol start=2><li><p>儲存文字檔，並將檔名設定成<code>MouseMover.ps1</code>放置於桌面。</p></li><li><p>針對檔案點選右鍵，選擇<code>用powershell執行</code>即可。</p></li></ol><p>程式碼每間隔10秒鐘會亂數移動一次滑鼠的座標位置，如果不喜歡的話，可以自行修改程式碼的第一行將<code>10</code>這個數字改掉，例如你想要一分鐘執行一次，可以改成<code>60</code>。</p><pre><code class=language-txt>[int]$iSeconds = 60
</code></pre><p>如果不想動程式碼的話，可以到桌面的路徑使用<code>powershell</code>帶入參數的方式執行，例如下方指令指定成每分鐘執行一次：</p><pre><code class=language-txt>PS C:\Users\Slashview\Desktop> powershell .\MouseMover.ps1 60
</code></pre><h2>Powershell執行權限問題（提升Powershell權限）</h2><p>如果啟動執行後出現意外，系統彈出下列這樣之類的訊息，代表你的Powershell的執行權限不足，這時候還是得必須使用<code>管理者</code>身分來提升權限。</p><pre><code class=language-txt>.\MouseMover.ps1 : 因為這個系統上已停用指令碼執行，所以無法載入 C:\Users\Slashview\Desktop\MouseMover.ps1 檔案。如需詳細資訊
，請參閱 about_Execution_Policies，網址為 https:/go.microsoft.com/fwlink/?LinkID=135170。
位於 線路:1 字元:1
+ .\MouseMover.ps1
+ ~~~~~~~~~~~~~~~~
    + CategoryInfo          : SecurityError: (:) [], PSSecurityException
    + FullyQualifiedErrorId : UnauthorizedAccess
</code></pre><p>按下<code>Windows + R</code>，輸入<code>powershell</code>後，同時按住<code>Ctrl + Shift</code>並按下<code>Enter</code>，系統會提示是否使用最高權限執行，點選<code>是</code>後在視窗中輸入下列指令提升powershell權限：</p><pre><code>Set-ExecutionPolicy Unrestricted

執行原則變更
執行原則有助於防範您不信任的指令碼。如果變更執行原則，可能會使您接觸到 about_Execution_Policies 說明主題 (網址為
https:/go.microsoft.com/fwlink/?LinkID=135170) 中所述的安全性風險。您要變更執行原則嗎?
[Y] 是(Y)  [A] 全部皆是(A)  [N] 否(N)  [L] 全部皆否(L)  [S] 暫停(S)  [?] 說明 (預設值為 "N"): A
</code></pre><p>選擇<code>A</code>直接允許全部指令碼即可。</p><p>完成後再去執行<code>MouseMover.ps1</code>應該就可以順利執行了。</p><h6>Windows Powershell nonInstall nonSetup PureScript Mouse AutoMoving AutoMover eLearn eLearning TaiwanGovernment OnlineVedio OnlineStream LearningDetection</h6></main><footer></footer><script src=/.file/site.js></script></body></html>