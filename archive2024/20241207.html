<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>在Windows Terminal下美化PowerShell指令輸入列</h1><p>今天剛好有空閒，來搞一下自己的PowerShell，讓命令模式下有比較多的色彩與視覺。</p><h2>讓自己的PowerShell有更好看的視覺表達</h2><p>Step 1. 在Windows Store下載Windows Terminal。</p><p>Step 2. 下載<a href=https://github.com/ryanoasis/nerd-fonts>NerdFonts</a>。</p><p>請到GitHub下載最新釋出的NerdFonts，我自己是選擇<code>FiraCode</code>字型，點選<code>Releases</code>後找到<code>Assets</code>應該可以看到<code>FiraCode.zip</code>，下載解壓縮後，我只有選擇安裝<code>FiraCode NerdFont Mono</code>系列的字形。</p><p>Step 3. 在Windows Terminal設定NerdFonts字型。</p><p>打開Windows Terminal的<code>設定</code>＞<code>預設值</code>＞<code>外觀</code>＞<code>字體</code>，選擇<code>FiraCode Nerd Font</code>。</p><p>Step 4. 安裝<code>oh-my-posh</code>軟體。</p><p>在Windows Terminal中開啟PowerShell，輸入以下的指令就可以安裝，安裝後將整個Windows Terminal<code>關閉並重新開啟</code>：</p><pre><code class=language-txt>Set-ExecutionPolicy Bypass -Scope Process -Force; Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://ohmyposh.dev/install.ps1'))
</code></pre><p>Step 5. 指定開啟PowerShell時的自動執行檔內容：</p><p>在PowerShell中建立一個開啟PowerShell時期會自動讀取的檔案。</p><pre><code class=language-txt>New-Item -Path $PROFILE -Type File -Force
</code></pre><p>透過記事本開啟這個檔案編輯：</p><pre><code class=language-txt>notepad $PROFILE
</code></pre><p>這時候桌面會彈出一個記事本檔案，請在檔案中貼上下列的內容後儲存：</p><pre><code class=language-txt>if ($env:WT_SESSION) {
  oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH\jandedobbeleer.omp.json" | Invoke-Expression
}
</code></pre><p>Step 6. 關閉所有的Windows Terminal，再重新開啟進入PowerShell後，就可以看到<code>命令列有精美的著色效果</code>了。</p><h3>補充說明</h3><ol><li>如果想要看其他的主題，可以到這裡查看並更換<a href=https://ohmyposh.dev/docs/themes>Oh-My-Posh Themes</a>，上面的<code>jandedobbeleer</code>就是其中的一個主題。</li><li>如果<code>$PROFILE</code>內文沒有加上<code>$env:WT_SESSION</code>判斷（是否於Windows Terminal環境？），這樣會讓Windows在一般模式下正常啟動Powershell時，因為套用Oh-My-Posh而產生亂碼。</li></ol><h6>WindowsTerminal PowerShell Cli Oh-My-Posh Pretty ColorSchemes Themes Icons</h6></main><footer></footer><script src=/.file/site.js></script></body></html>