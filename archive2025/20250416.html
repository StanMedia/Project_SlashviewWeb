<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>透過Windows防火牆來限制遠端桌面只允許某些IP可監聽</h1><p>這次的目標有點反向，我們都知道一張網卡其實可以綁定多組IP，但是當我們開啟了Windows的<code>遠端桌面允許連入</code>之設定後，Windows其實會讓所有的IP都處於監聽狀態<code>0.0.0.0:3389 / LISTENING</code>，這樣的情況下我們可以透過Windows防火牆來限制遠端桌面只允許這張網卡下的<code>某些IP可監聽</code>（例如我們只想讓此電腦的私有IP：<code>192.168.1.10</code>處於監聽狀態），避免把遠端桌面的連線直接暴露在公開IP之下。</p><h2>Windows遠端桌面無法設定單一IP監聽</h2><p>在Windows的遠端桌面設定中，我們無法直接指定某個IP來監聽，這是因為Windows的遠端桌面服務會自動將所有的IP都設為監聽狀態。這樣的設計雖然方便，但在某些情況下可能會造成安全隱患。</p><p>但好險Windows防火牆可以幫助我們解決這個問題，讓我們能夠限制遠端桌面只允許某些IP可監聽。請跟著下方的步驟進行設定即可：</p><p>Step 1. 開啟Windows防火牆，<code>Win + R</code>，輸入<code>wf.msc</code>然後按下Enter鍵。</p><p>Step 2. 在左側的選單中選擇<code>輸入規則</code>，然後在右側的操作面板中找到<code>遠端桌面 - XXXX</code>共3筆資料，點擊<code>第1筆</code>規則並打開<code>領域</code>頁籤。</p><p>Step 3. 在<code>本機IP位址</code>處點選<code>這些IP位址</code>，然後將（假設）<code>192.168.1.10</code>新增到列表裡，並點選<code>確定</code>。</p><p>Step 4. 之後再針對剩下的<code>第2筆</code>、<code>第3筆</code>重複1~3的步驟，就達成期望目的了。</p><h2>結論</h2><p>Windows遠端桌面無法指定哪個IP來監聽，但我們可以透過Windows防火牆來限制遠端桌面只允許某些IP可監聽，透過這樣的手法來達成讓公眾IP不可連入RDP的風險規避。</p><h3>相關連結</h3><ul><li><a href=/archive2024/20240923.html>透過Windows防火牆來限制遠端桌面只允許某些IP可連入</a></li><li><a href=/archive2025/20250416.html>透過Windows防火牆來限制遠端桌面只允許某些IP可監聽</a></li></ul><h6>Windows RDP Specified Specific Limited IP Listening</h6></main><footer></footer><script src=/.file/site.js></script></body></html>