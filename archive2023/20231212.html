<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>Windows netstat網路觀察指令整理</h1><p>一直以來也沒有特別的花時間去理會Windows <code>netstat</code>的相關指令，通常都是直接下<code>netstat -an</code>或<code>netstat -bn</code>就解決了，透過這篇文章把<code>netstat</code>的常用指令整理一下，以備不時之需。</p><h2>netstat -n</h2><p>Number；顯示IP位址和埠號。</p><h2>netstat -a</h2><p>All；列出所有活動與非活動的TCP與UDP連線。</p><h2>netstat -b</h2><p>不明字母；列出連線後端所屬的應用程式，但不一定都查詢的到。</p><h2>netstat -o</h2><p>不明字母；列出連線後端所屬的Process ID（PID）。</p><h2>netstat -p</h2><p>Protocol；列出TCP或UDP連線，例如：<code>netstat -p TCP</code>。</p><h2>netstat -q</h2><p>不明字母；列出偵聽埠和綁定的非偵聽埠的所有連接的清單。</p><h2>netstat -t</h2><p>Terminate；列出準備關閉的網路連線清單。</p><h2>netstat XX | findstr "something"</h2><p>尋找輸出關鍵字串。</p><h2>netstat XX INTERVAL</h2><p>監控狀態，隔幾秒重新輸出一次。</p><h3>複雜的組合範例</h3><p>列出<code>全部</code>且<code>以號碼陳列</code>且<code>出示PID號碼</code>且<code>通訊協定</code>為<code>TCP</code>且<code>間隔一秒更新一次</code>，僅找出字串符合<code>99.84.238.97</code>的項目。</p><pre><code class=language-txt>netstat -anop TCP 1 | findstr "99.84.238.97"
</code></pre><p>然後你就可以在console看到一系列的監控輸出：</p><pre><code class=language-txt>TCP    XX.XX.XX.XX:8129     99.84.238.97:443       ESTABLISHED     12188
TCP    XX.XX.XX.XX:8129     99.84.238.97:443       ESTABLISHED     12188
TCP    XX.XX.XX.XX:8129     99.84.238.97:443       TIME_WAIT       0
TCP    XX.XX.XX.XX:8129     99.84.238.97:443       TIME_WAIT       0
TCP    XX.XX.XX.XX:8129     99.84.238.97:443       TIME_WAIT       0
</code></pre><h6>Windows CMD Network Monitor Netstat Guide</h6></main><footer></footer><script src=/.file/site.js></script><script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7039045520564660"></script></body></html>