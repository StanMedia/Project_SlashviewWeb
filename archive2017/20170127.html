<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>如何在在Excel中找出BIG5的使用者造字字元？</h1><p>今天收到了一個難題，就是如何在Excel的某姓名欄位中，找出該姓名中是否有出現BIG5的造字字元（使用者造字文字），由於敝人一向都是走程式設計，完全沒有再用Excel，當下腦袋是一片空白，只好開始翻閱網路文章補充知識，但不幸的，並沒有太多的文章在討論這方面的事情。（都甚麼時代了還在用BIG5，改用Unicode不好嗎？）</p><p><img src=https://content.slashview.com/img/2017/20170127_01.jpg alt="" /></p><p>所幸經過文章的翻閱時期，突然在腦中閃過曾經在倚天中文、Windows 95時期對於「造字程式」有一點依稀模糊的印象，好像起始是在那萬惡的「FA40」區，好，就以此為方向吧！首先先打開萬惡的造字程式，驗證一下自己的印象是否有誤？如下圖：</p><p><img src=https://content.slashview.com/img/2017/20170127_02.jpg alt="" /></p><p>因此得到BIG5於Windows的造字區塊，總共被區分為四個區塊，以下列出BIG5與Unicode之於使用者自行造字之間的對照關係：</p><pre><code class=language-txt>1.  「Ｂ」ＦＡ４０－ＦＥＦＥ（　７８５字）　→　「Ｕ」Ｅ０００－Ｅ３１０（　７８５字）
2.  「Ｂ」８Ｅ４０－Ａ０ＦＥ（２９８３字）　→　「Ｕ」Ｅ３１１－ＥＥＢ７（２９８３字）
3.  「Ｂ」８１４０－８ＤＦＥ（２０４１字）　→　「Ｕ」ＥＥＢ８－Ｆ６Ｂ０（２０４１字）
4.  「Ｂ」Ｃ６Ａ１－Ｃ８ＦＥ（　４０８字）　→　「Ｕ」Ｆ６Ｂ１－Ｆ８４８（　４０８字）
5.  「Ｂ」Ｆ９Ｄ６－Ｆ９ＦＥ（　　４１字）　→　「Ｕ」Ｆ８４９－Ｆ８ＦＦ（　１８３字）
</code></pre><p>以上這是我在網路上找到的資料，我將其混合得到這個初步的結論。由這些對映可以發現其實Unicode跟BIG5在使用者造字區塊上無法完全對上，Unicode BMP（Basic Multilingual Plane）所訂定的Private Use Area可使用字元數目為6,400 code points。當然這個結論或對照表可能是錯誤的，歡迎懂這方面知識的網友分享一下，若敝人在日後有發現新的知識，也會隨時回來這一頁進行內容的更新。</p><p>※註：如果你用計算機去算BIG5的區間，例如ＦＡ４０－ＦＥＦＥ，會得到錯誤的區間總量數字，因為中間有跳碼啊（EX: FA7E之後跳到FAA1、FAFF之後跳成FB40...），打開「造字程式」看畫面就知道我在說啥。</p><p>※Reference: <a href=http://www.cns11643.gov.tw/AIDB/encodings.do>全字庫中文碼介紹</a></p><h2>撰寫Excel判斷是否為使用者造字字元之函式（公式）</h2><p>詢問一下之前的造字環境，得到業管單位只有使用到第一區塊，也就是ＦＡ４０段，因此將FA40(HEX)轉換成十進制，也就是「64064(DEC)」。（所以其他的造字區識別，容我偷懶沒有實作）</p><p>簡單的說，就是逐一取字，丟到CODE函式中進行轉碼，接著判斷是否大於等於64064，如果是的話，就斷定這個字元是使用者自行造字的字元，需要再進行進一步的處理。在這邊我只假設姓名最多四個字，再多的請自己修改公式了。</p><pre><code class=language-txt>=IF(IFERROR(CODE(MID(A1, 1, 1)), 0) >= 64064, "✗第一個字", IF(IFERROR(CODE(MID(A1, 2, 1)), 0) >= 64064, "✗第二個字", IF(IFERROR(CODE(MID(A1, 3, 1)), 0) >= 64064, "✗第三個字", IF(IFERROR(CODE(MID(A1, 4, 1)), 0) >= 64064, "✗第四個字", "✓"))))
</code></pre><p>就這樣解完。套句現在熱門的語句：「寫的雖可恥但有用！」。畢竟，我可不願意在Excel上多花一秒的時間呢～</p><p><img src=https://content.slashview.com/img/2017/20170127_03.jpg alt="" /></p><h3>相關參考</h3><ul><li><a href=/archive2018/20180927.html>列舉Windows作業系統下的造字檔內的所有文字（粗略版）</a></li><li><a href=/archive2022/20221222.html>列舉Windows作業系統下的造字檔內的所有文字（精準版）</a></li><li><a href=/archive2018/20180925.html>找出字串中隱藏的Big5造字字元，並用Unicode將其取代</a></li><li><a href=/archive2017/20170127.html>如何在在Excel中找出BIG5的使用者造字字元？</a></li><li><a href=/archive2021/20211122.html>更新造字字型檔（EUDC Fonts）的批次小程式</a></li></ul><h6>使用者造字 造字程式 Excel Big5 Unicode EUDC EndUserDefinedCharacters Chinese</h6></main><footer></footer><script src=/.file/site.js></script></body></html>