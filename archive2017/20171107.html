<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>對Windows系統的容量進行縮小、瘦身動作</h1><p>對於Microsoft的Windows作業系統，每次越更新就越肥大的這件事情，實在感到很無奈，尤其在現代SSD硬碟寸土寸金的年代，系統裡面有一些根本用不到的垃圾，實在看了很討厭！最進開始有需求把整個Windows的虛擬化映像檔丟到雲端，越發有這方面的需求，因此撰寫了這篇文章筆記一下。</p><p><img src=https://content.slashview.com/img/2017/20171107_01.jpg alt="" /></p><h2>針對你的Windows總容量進行縮減的四種方法</h2><ol><li><p>（時常要做）用最高權限（Administrator）調用「磁碟清理程式」，先對你的系統進行全面的清除。（包含歷史更新、前一個版本的Windows的備份檔案都要清掉）</p></li><li><p>（做一次就好）在2017 Windows Fall Creators Update後，在「設定」＞「系統」＞「儲存空間」＞「儲存空間感知器」＞「變更空間釋放方式」中，有許多在開機的狀態下會自動幫你感知與清理的選項，建議全部勾選，並且手動再清理一次。</p></li><li><p>（時常要做）消除令人厭煩的WinSxS備份。在每一次的KM更新，微軟都會將一些舊的DLL或是核心程式備份到WinSxS這個資料夾中，以利出包的還原工作。WinSxS看起來很大，但其實所佔據的容量並非真正的容量，而是以檔案與檔案間互相LINK去計算出來的（虛胖）。然而，舊有程式庫佔據部分的空間是事實，雖然在Windows 8.1之後微軟已經慢慢地改進這部分的作為，但是仍有其「時程性」，也就是說，定期清理程式會在一定的時間到達後，才會去清理他。但說真的，因為微軟已經把這部分改善了，所以這行指令並不能為你清理出太多空間，了不起一兩百MB而已。</p></li></ol><p>我們可以下這個指令，快速的手動把他們清除一遍。不用緊張，這個指令並不會破壞你電腦的任何系統（<a href=https://msdn.microsoft.com/zh-tw/library/dn251565.aspx>MSDN文件：清理 WinSxS 資料夾</a>可證明），但是如果你去用外面開發的DISM++之類的程式，這...我就不好說了！</p><pre><code class=language-txt>//CMD要用最高權限（Administrator）
DISM.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase
</code></pre><ol start=4><li>（做一次就好）利用CompactOS，將Windows 10核心的DLL程式庫，進行二進制的壓縮，其餘的私有第三方程式、個人檔案則不會壓縮。以現代的CPU來說，這些簡單的壓縮演算透過CPU要解壓縮，並非是一個沉重的負擔，因此我們可以利用這個方法，用CPU換取DISK空間。（當然，對低等級的機器來說，整體OS效能可能會略為減慢；但反過來說，在DISK IO跟CPU都是高速的機器下，CompactOS可以有效地縮短IO量，反而有助於提升系統運行速度。）</li></ol><pre><code class=language-txt>//查詢系統檔案壓縮狀態
COMPACT.EXE /CompactOS:query
//開啟系統自動壓縮系統二進位檔案功能
COMPACT.EXE /CompactOS:always
//關閉系統自動壓縮系統二進位檔案功能
COMPACT.EXE /CompactOS:never
</code></pre><p>最後再補充一點，如果你這是在VM的環境下，別忘了做完這些動作後，記得去把你的虛擬硬碟檔案Shrink一下喔！以VMware為例，UI有提供方便的功能（免在那邊把磁區標記成ZERO），建議你可以把GuestOS關機後，請到該部虛擬主機按右鍵＞Manage＞Clean Up Disks，會幫你把VMDK檔案清出很多意想不到的空間出來喔！</p><h6>Windows10 HardDisk HDD SSD Quota Reduce Shrink Compact 容量縮小 容量壓縮 垃圾清理</h6></main><footer></footer><script src=/.file/site.js></script></body></html>