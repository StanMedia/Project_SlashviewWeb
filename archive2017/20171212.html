<!DOCTYPE html><html><head><meta charset=utf-8 /><meta name=viewport content="width=device-width, initial-scale=1" /><link href=/.file/site.css rel=stylesheet /><script src=/.include/jquery/jquery.min.js></script></head><body><header></header><main><h1>快速進行WSP網站之C#（Roslyn）編譯器相關檔案覆蓋作業</h1><p>在之前討論到「<a href=/archive2017/20170817.html>在ASP.NET WSP模式中，啟用C# 7.0（Roslyn）編譯器</a>」的文章中有指出，微軟在.NET Framework的升版更新中，很多DLL檔案的擁有權限基於安全的理由，將其變更為「TrustedInstaller」。這樣的問題將會造成，當「Administrator」想要進入置換檔案的時候，就被系統基於權限不合、不夠的理由被踢出了。</p><p>更慘的是，要解決這個問題，得要手動的一個一個點選UI介面來完成，實在有夠惱人。</p><p>今天又有類似的工作需要進行，因此寫了一個小程式，讓使用者可以快速地進行檔案權限變更，以利將Roslyn編譯器所需要的檔案，快速的複製到對應的目錄下。</p><h2>檔案擁有者、檔案讀寫權限指令快速產生器</h2><p>概念很簡單，就是利用「takeown」以及「icacls」這兩隻程式來幫我們處理。</p><ol><li>在文字框輸入要編碼的字串後，按下Enter會自動進行HTML Encode。</li><li>可以隨意的點選藍色、紅色按鈕，多次的編解碼您的HTML。</li></ol><form><div class="row mb-3"><label for=iStockPrice class="col-md-4 col-form-label">請填入.NET Framework的運行目錄：</label><div class=col-md-8><input type=text id=uDirectory class=form-control placeholder=".NET Framework Directory, e.g. [C:\Windows\Microsoft.NET\Framework64\v4.0.30319]" /></div></div><div class="row mb-3"><label for=iStockItems class="col-md-4 col-form-label">請填入Roslyn編譯器的tools目錄下，所有的檔案名稱：</label><div class=col-md-8><textarea id=uFiles class=form-control rows=20 placeholder="Paste all under directory:[Microsoft.Net.Compilers\tools] files name here."></textarea></div></div><div class="row mb-3"><div class="offset-md-4 col-md-10"><button id=uMakeScript class="btn btn-large btn-primary" type=button>Generate Script 產生指令</button> <button id=uClear class="btn btn-large btn-outline-secondary" type=button>Clear 清除</button></div></div></form><script>$(function(){$("#uDirectory").focus();$("#uMakeScript").click(function(){for(var r=$("#uDirectory").val(),t=$("#uFiles").val().split("\n"),i="",n=0;n<t.length;n++)i+="takeown /F "+r+"\\"+t[n]+" /A\n",i+="icacls "+r+"\\"+t[n]+" /grant Administrators:(GR,GW,GE)\n";$("#uFiles").val(i);$("#uFiles").focus()});$("#uClear").click(function(){$("#uFiles").val("");$("#uFiles").focus()})})</script><p>※ 轉換後，記得要用最高管理權限開啟cmd console，然後把指令字串貼上去就解決了。</p><h3>相關連結</h3><ul><li><a href=/archive2021/20210114.html>在ASP.NET WSP模式中，啟用C# 8.0（Roslyn）編譯器</a></li><li><a href=/archive2017/20170817.html>在ASP.NET WSP模式中，啟用C# 7.0（Roslyn）編譯器</a></li><li><a href=/archive2016/20160617.html>在ASP.NET WSP模式中，啟用C# 6.0（Roslyn）編譯器</a></li><li><a href=/archive2017/20171211.html>在不使用nuget的情況下，讓WSP可以在VisualStudio中使用C#新語法</a></li></ul><h6>Windows Explorer File Folder Permission Change Modify Script AutoBatch</h6></main><footer></footer><script src=/.file/site.js></script></body></html>